'use client'

import gsap from 'gsap'
import { ScrollTrigger } from 'gsap/ScrollTrigger'
import { useEffect } from 'react'

gsap.registerPlugin(ScrollTrigger)

export default function BranchView() {
  useEffect(() => {
    gsap.set('#branch-mask', {
      clipPath: 'inset(0% 0% 100% 0%)',
    })

    gsap.to('#branch-mask', {
      clipPath: 'inset(0% 0% 0% 0%)',
      ease: 'none',
      scrollTrigger: {
        trigger: '#page-1',
        start: 'bottom bottom',
        endTrigger: '#page-5',
        end: 'bottom bottom',
        scrub: true,
      },
    })

    ScrollTrigger.create({
      trigger: '#page-3',
      start: 'top top',
      end: 'bottom top',
      onEnter: () => {
        gsap.to('#branch-svg-container', { opacity: 0, duration: 0.5 })
      },
      onLeaveBack: () => {
        gsap.to('#branch-svg-container', { opacity: 1, duration: 0.5 })
      },
    })

    ScrollTrigger.create({
      trigger: '#page-4',
      start: 'top top',
      end: 'bottom top',
      onEnter: () => {
        gsap.to('#branch-svg-container', { opacity: 1, duration: 0.5 })
      },
      onLeaveBack: () => {
        gsap.to('#branch-svg-container', { opacity: 0, duration: 0.5 })
      },
    })

    ScrollTrigger.create({
      trigger: '#page-6',
      start: 'top center',
      onEnter: () => {
        gsap.to('#branch-svg-container', { opacity: 0, duration: 1 })
      },
      onLeaveBack: () => {
        gsap.to('#branch-svg-container', { opacity: 1, duration: 1 })
      },
    })

    return () => {
      ScrollTrigger.getAll().forEach(trigger => trigger.kill())
    }
  }, [])

  return (
    <div
      id="branch-svg-container"
      className="fixed top-0 left-0 w-full h-full pointer-events-none z-10 hidden lg:block"
      style={{ overflow: 'visible' }}
    >
      <div id="branch-mask" className="w-full h-full">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 1967.33 1804.37"
          preserveAspectRatio="none"
          className="w-full h-full"
        >
          <path
            id="branch-path"
            d="M696.94,864.48c27.78,7.12,69.47-1.41,93.54-17.74,16.09,13.92,30.59,39.83,43.74,56.35,37.41,23.31,60.45,40,115.59,64.99,19.8,33.8,29.1,42.85,77.13,54.07,12.54-11.29,41.86,0,47.78-8.69-11.91-3.33-37.34-9.13-48.75-2.67,0,0-38.17-9.92-38.17-9.92,0,0-21.19-25.39-21.19-25.39-1.42-5.71-4.79-17.28-9.5-21.17-52.48-12.2-128.94-60.61-139.69-151.07.01,0,16.01-88.45,5.3-107.77,24.89,11.8,64.57,60.03,70.67,107M818.39,7.12c103.56,47,219.41,161.34,272,261.99,12.09,59.11,27.09,148.22,50.16,203.42-2.71,31.04,12.87,88.71,26,116.67,0,0,45.99,83.33,45.99,83.33,0,0,26-1.33,28.67,18.67.4,26.83,8.18,94.32-38,108,0,0-6.66,18.67-6.66,18.67,7.6,11.39,14.41,28.67,11.33,42.67,17.95,32.77-38.42,85.21-47.95,117.76-18.68,44.53-51.01,105.03-84.98,147.46-28.07,20.93-54.81,62.67-80.32,88.34-27.25,24.85-59.02,26.92-85.14,58.96-7,5.71-19.99,9.65-24.33,17.92-38.13,19.91-103.86,49.54-108.42,98,0,0-16,.17-20.75-24.25-42.95-47.31-62.68-111.67-82.22-172.36,1.6-7.53-7.25-25.68-10.61-32.68-46.24-53.06,23.25-84.83-.49-133.61,5.4-25.73-10.46-47.45-27.57-79.78-14.55-26.79-22.91-166.93-72.97-180.94-23.83-50.82,3.37-110.85,24.05-155.82,18.62,55.96,71.6,110.7,117.49,146.01-1.15,9.67,10.64,19.38,17.5,24.21,5.37-3.79,55.28,13.76,61.5,14.87,10.94,60.63-63.05,63.64-104.75,56.95M1240.19,127.12c-46.98,142.19-54.04,82.61-113.81,177.99-16.6-117.77-188.41-223.12-271.43-299.98M1252.92,228.81c-1.24,23.54-8.07,70.58-18.68,91.58.16,17.57,7.25,52.34-12.11,63.11,57.65,10.67,180.74,159.3,87.77,249.05-.02-.01-26.02,39.32-26.02,39.32-46.66,38.91-113.87-150.11-111.33-184.67-4.21-116.24-93.43-139.44,44.51-248.63-2.34-25.71,29.02-103.2,37.52-127.52M1301.42,226.14c-5.88,18.1-26.1,45.34-41.85,56.02,0,0,1.63-64.5,1.63-64.5M1928.49,1070.43c-141.23,107.34-175.12-55.84-280.38-89.87,1.44-23.7-.55-55.57-10.01-77.36-4.67,2.22-56.22-17.82-62.33-21-8.44-8.64-30.12-25.59-39-33-121.38-179.59,5.32-72.71-10.32-206.67-23.78-30-50.38-31.9-64.68-76-1.33-29.56-12.19-64.73-42-74.66-3.82,10.75-12.63,30-25.67,31.33,1.44-119.91-120.87-114.46-130.99-215.25,15.86-20.87,38.77-67.07,46.03-92.2M1724.05,1103.28s-24-21.17-24-21.17c-47.68-22.35,3.36-4.58-49.61-78.25,69.37-38.05,75.56,226.59,215.39,167.55M1651.76,1261.04c12.31-28.3,35.72-67.44,1.66-89.33,1.82-22.77-7.33-65.57-16.11-86.56,0,0,5.37-16.99,5.37-16.99l52.54,55.12,7.62,49.01M1528.15,1300.43c2-3.3,47.37-58.09,47.11-58.19-5.96-15.1,34.92-124.06,38.87-140.29,23.13,13.95,22.07,55.26,26.19,76.59,35.04,19.36,17.07,53.22,6.61,82.06M1372.55,1096.09l-31.36-15.08c18.2-7.18,27.18-11.54,44.33,1.23,17.05-13.17,40.02-19.02,56.03-35.81,4.32-.69,5.6,10.15,14.89,10.89,19.2,7.14,20.19-16.49,24.67-26.22,10.71-2.73,104.31,35.18,119.24,73.89-10.12,49.02-36.17,161.15-76.31,195.46M1381.19,1133.01l-38.11-41.22,33.81,11.53M1031.52,1242.09s-45.56,3.33-45.56,3.33c43.9-35.14,88.49-87.79,124.45-130.89,79.54-34.47,174.96-74.47,228.98-149.21,0-.01,19.47,6.75,16.32,17.15-2.15,21.42,31.87,42.85-1.28,49.94-8.4,9.2-10.4,13.91-23.22,15.33-3.73,4.97-18.62,18.39-14.11,25.56,11.38,14.23,41.89,50.09,54.08,64.36M873.74,1738.09c-13.16-4.15-14.79-20.49-16.66-31.78,13.98-7.36,51.88-27.33,64.89-35.11,20.72-23.74,47.23,19.97,58.89-33.33,16.98,38.19,63.61,68.08,101.11,82.89,22.46,14.77,52.32,53.52,85.77,46.45,0,0-11.11,1.78-17.78-3.78-26.7-21.77-122.87-53.99-175.34-156.21-42.01-53.05-125.16-104.92-167.54-157.12-1.78,1.33,7.56-9.78-4.22-29.33-4.03-18.63-6.24-47.72,22.89-61.11,18.81-27.5,63.86-55.36,98.22-62,34.13-29.68,57.63-48.91,105.78-44M852.63,1800.69c.64-22.5-2.72-57.45-2-79.93,3.91,11.62,11.22,20.45,23.56,23.33M840.85,1748.76c3-26.89,1.62,46.51,1.78,55.11M750.63,1758.53c4.04-16.88,26.75-27.46,42.67-28.89,0,0,26-13.11,26-13.11,5.84,2.35,11.84-.79,16.22-4.67,13-7.6.2,9.59,1.56,13.34,0,0-1.78,22.22-1.78,22.22M854.71,1594.68c-2.34-14.28-16.2-58.98-20.6-73.47,20.61,35.13,35.37,90.71,42.75,130-11.89,13.31-43.01,23.35-38,44.89-10.95,5.09-38.9,18.17-49.11,23.78-10.6-3.76-31.96,10.08-40.45,15.11,0,0-6.22,20.66-6.22,20.66M662.6,1317.84s28.22-6.67,28.22-6.67c20.34,25.59,37.59,79.39,53.11,108.22,53.91,43.06,78.06,113.37,103.8,178.7M614.83,1152.73c-3.27.37,19.02-58.61,19.11-16.22,7.55,26.93,29.29,61.9,34.22,109.33.88,2.73,2.32,9.84,6.22,10,5.38,22.67,19.12,45.4-13.11,55.33M576.83,1095.62c54.69,16.76,25.22,15.85,26.44,62.22M621.02,1075.21c-12.15,37.12-3.54,26.06-45.75,14.18M505.35,950.52c29.5-11.38,53.28-4.82,98.58-36.9-.11,2.57,17.76,28.06,8.73,33.63,0,0,2.27,5.96,2.27,5.96l5.2,2.18c-3.36-1.74,40.03,52.17,23.05,68.29-.26,6.3,3.21,14.17,9.3,16.78,13.22,18.86-42.76,94.94-23.72,30.42M.5,1.72c115.19,112.1,284.32,251.47,437.01,308.5,38.7,57.48,156.49,158.82,121.11,242.95-15.1,22.99-21.43,118.77-60.45,151.56-3.93,3.36-3.19,31.18,21.99,36.44,2.75-2.95,28.84,57.73,36.13,66.36-9.19,6.49-52.4-3.32-58.35,19.64,22.21,12.55,9.48-22.06,71.18,2.2,27.01,49.83,74.76,89.76-77.62,121.35M350.75,35.17C471.1,429.25,144.03,103.23,19.53.5M829.5,117.9c20.5,70.95-14.07,150.79-45.35,211.67,34.7,44.95-21.76,97.73-31.71,160.47-76.44,23.52-178.12-50.57-232.5-161.25-9.43-22.96-38.28-57.55-59.45-70.55-119.96-19.58-2.6-27.5-99.74-217.4M1009.09,157.53c-95.56,66.79-50.25,162.26-192.56,197.88-22.96-69.28,51.37-101.9,19.59-246.98M1181.5,46.57c-46.6,4.26-125.88,69.99-159.08,100.02M1032.12,157.24c35.62-33.88,116.38-98.21,166.13-106.68M911.72,771.14c-46.24-42.13-81.4-90.27-98-167.67-2.47-44.95-87.62-161.24,16.67-227.67,151.79-44.1,96.24-132.7,188.44-207.45M612.34,552.42c49.27-80.82,10.01-38.03,104.71-38.39,58.88,16.89,59.33,90.89,59.33,90.89,17.91,106.55,37.8,240.85-65.78,128-58.63-44.22-116.65-120.03-98.26-180.5ZM750.66,1387.2c-8.78.16-29.54-56.63-32.67-62.5,7.93,11.8,40.29,46.11,32.67,62.5ZM785.22,1377.76c-.55-6.46,4.17-10.09,9.34-12.17,0,0-9.34,12.17-9.34,12.17ZM956.1,1634.92c5.29,30.72-55.23,9.37-58,24.89,8.17,10.47-46.63,26.31-50,30.23,27.37-43.42,46.15-13.25,36-36.67,10.85-18.55,51.52,4.03,72-18.45ZM950.44,1619.09c-2.33,15.17-12.33,10.67-12.33,10.67,2.67-15.5-31.67-57-31.67-57,25.83,14.17,44,46.33,44,46.33ZM887.6,1553.92c6.5,33.17,35.83,64.17,35.83,64.17-.78,30.64-16.39,16.24-31,16.33-9.91,40.3-38.11-122.55-42.51-118.49,0,0,37.68,38,37.68,38ZM865.38,1312.09c-32.87,23.63-53.19,38.91-9.5.84,0,0,44.17-23.5,44.17-23.5l-34.67,22.67ZM1315.66,780.2c-6.34,42.37-11.58,111.05-1.33,153.33-5.34,60.86-165.37,158.89-183.03,151.89-6.69-42.1,129.66-196.76,100.61-243.55-21.05-49.36,47.34-32.8,40.64-132.67,10.3-27.1,31.41,4.11,32.45-30.66,5.6-12.93,20.8-37.12,32.22-45.78,0,0-21.56,147.44-21.56,147.44ZM1610.77,915.53c13.08-2.78,17.67,35.69,21.78,52.44,0,0-23.56-18.44-23.56-19.11-9.58-17.23-32.12-36.81-40.89-54.45,2,0,42.67,21.11,42.67,21.11ZM1488.77,788.2c7.32,11.22,19.95,37.05,28.44,46.22-23.04-6.49-40.23-43.45-62-52.89-5.1-15.08-6.31-24.65,10.23-31.78,2.69,5.86,19.14,31.85,23.33,38.44ZM1432.99,601.42c2.32-14.23,4.96-16.92,18.22-22.64,35.81,78.98,68.6,40.14,44.14,119.63-41.47,27.2-65.89-26.37-54.86-42.86,0,0-8.2-10.26-8.2-10.26-.81-3.81-3.2-9.6-7.56-10.44-.74-10.51-5.03-28.22,8.25-33.43ZM1385.66,1045.98c-15.17,12.17-21,4.5-21,4.5,27.83-7.67,33.5-45.17,33.5-45.17,10.4-3.73,15.34,10.34,19.61,16.84-4.39.33-32.11,23.83-32.11,23.83ZM1424.99,1018.14c-11.24-25.59-7.97-7.19,14.67-6.22,0,0-14.67,6.22-14.67,6.22ZM1505.88,1001.2c-23-35.33-103-51-103-51-8.82-37.34-51.41-34.03-54.42-85.55,10.07-95.33,55.27-225.38,49.06-317.85,14.44,23.24,19.07,62.44,13.69,88.74,6.64,13.05,10.72,31.91,7.34,46.33,57.09,42.8,3.52,46.82,10.33,98,38.71,39.05,132.02,146.93,166.66,174.01,44.53,20.15,32.4,81.88,14.34,81.33-77.67-7-104-34-104-34ZM1615.1,1080.98c1.78,29.98-41.92-34.22-83.56-43.99,0,0,86,14.44,83.56,43.99ZM1629.77,1042.76c-3.56,4.89-11.33,0-11.33,0,6.44-1.33,15.33-28.67,15.33-28.67l-4,28.67ZM1669.49,1066.09c-37.49-15.32-20.37-13.95-20.83-44.45,26.66,36.22,20.83,44.45,20.83,44.45ZM1859.16,1158.42c-108.51,48.12-127.33-99-127.33-99,63,47.7,147.95,76.1,221.33,34.33M1937.49,1070.43l-29.67,31.52,59-15.76"
            stroke="#ce9a34"
            strokeWidth="0.6"
            fill="none"
            strokeLinecap="round"
            strokeLinejoin="round"
          />
        </svg>
      </div>
    </div>
  )
}
